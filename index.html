<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS加密解密工具</title>
    <link rel="icon" type="ico" href="javascript.ico">
    <style>
        @font-face {
            font-family: 'SmileySans-Oblique-2';
            src: url('SmileySans-Oblique-2.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SmileySans-Oblique-2', sans-serif;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
            font-weight: normal;
        }
        
        :root {
            --bg-color: #f5f7fa;
            --text-color: #333;
            --container-bg: white;
            --border-color: #e1e5eb;
            --section-border: #3498db;
            --primary-color: #3498db;
            --primary-hover: #2980b9;
            --secondary-bg: #ecf0f1;
            --secondary-hover: #dde4e6;
            --secondary-text: #2c3e50;
            --success-color: #27ae60;
            --success-hover: #219653;
            --error-color: #e74c3c;
            --error-bg: #fdecea;
            --warning-bg: #fff9e6;
            --warning-border: #f1c40f;
            --warning-text: #e67e22;
            --placeholder-bg: #f8f9fa;
            --placeholder-border: #bdc3c7;
            --placeholder-text: #7f8c8d;
            --stats-bg: #f8f9fa;
            --stats-border: #e9ecef;
            --stats-label: #6c757d;
            --slider-bg: #dfe6e9;
            --remove-btn-bg: #f5f7fa;
            --remove-btn-border: #e0e0e0;
            --remove-btn-color: #95a5a6;
            --remove-btn-hover: #edf2f7;
            --shadow-color: rgba(0, 0, 0, 0.05);
            --theme-btn-bg: #f0f0f0;
            --theme-btn-hover: #e0e0e0;
            --theme-icon-color: #666;
            --textarea-bg: #ffffff;
            --textarea-border: #d1d9e0;
            --textarea-focus: #3498db;
            --method-btn-bg: #f1f8ff;
            --method-btn-border: #c8e1ff;
            --method-btn-active: #3498db;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --modal-bg: rgba(255, 255, 255, 0.15);
            --modal-border: rgba(255, 255, 255, 0.2);
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
        }
        
        .dark-mode {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --container-bg: #2d2d2d;
            --border-color: #404040;
            --section-border: #3498db;
            --primary-color: #3498db;
            --primary-hover: #2980b9;
            --secondary-bg: #404040;
            --secondary-hover: #505050;
            --secondary-text: #e0e0e0;
            --success-color: #27ae60;
            --success-hover: #219653;
            --error-color: #e74c3c;
            --error-bg: #3c1f1f;
            --warning-bg: #3c2e1f;
            --warning-border: #f39c12;
            --warning-text: #f1c40f;
            --placeholder-bg: #333333;
            --placeholder-border: #555555;
            --placeholder-text: #aaaaaa;
            --stats-bg: #333333;
            --stats-border: #404040;
            --stats-label: #aaaaaa;
            --slider-bg: #555555;
            --remove-btn-bg: #404040;
            --remove-btn-border: #555555;
            --remove-btn-color: #aaaaaa;
            --remove-btn-hover: #505050;
            --shadow-color: rgba(0, 0, 0, 0.2);
            --theme-btn-bg: #404040;
            --theme-btn-hover: #505050;
            --theme-icon-color: #ffffff;
            --textarea-bg: #252525;
            --textarea-border: #444;
            --textarea-focus: #3498db;
            --method-btn-bg: #353535;
            --method-btn-border: #444;
            --method-btn-active: #2980b9;
            --glass-bg: rgba(15, 23, 42, 0.7);
            --glass-border: rgba(148, 163, 184, 0.2);
            --modal-bg: rgba(15, 23, 42, 0.9);
            --modal-border: rgba(59, 130, 246, 0.3);
            --card-bg: rgba(30, 41, 59, 0.5);
            --card-border: rgba(148, 163, 184, 0.1);
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .subtitle {
            color: var(--placeholder-text);
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .theme-toggle {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .theme-label {
            font-size: 0.9rem;
            color: var(--text-color);
        }
        
        .theme-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--theme-btn-bg);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .theme-btn:hover {
            background-color: var(--theme-btn-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        
        .theme-btn:active {
            transform: translateY(0);
        }
        
        .sun-icon, .moon-icon {
            position: absolute;
            width: 24px;
            height: 24px;
            transition: opacity 0.3s, transform 0.3s;
        }
        
        .sun-icon {
            opacity: 1;
            transform: scale(1);
        }
        
        .dark-mode .sun-icon {
            opacity: 0;
            transform: scale(0.5) rotate(90deg);
        }
        
        .moon-icon {
            opacity: 0;
            transform: scale(0.5) rotate(-90deg);
        }
        
        .dark-mode .moon-icon {
            opacity: 1;
            transform: scale(1) rotate(0);
        }
        
        .sun-circle {
            fill: var(--theme-icon-color);
        }
        
        .sun-rays {
            fill: var(--theme-icon-color);
        }
        
        .moon-body {
            fill: var(--theme-icon-color);
        }
        
        .moon-crater {
            fill: var(--theme-icon-color);
            opacity: 0.7;
        }
        
        .main-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .text-section {
            background: var(--container-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .section-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--section-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .section-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .textarea-container {
            margin-bottom: 25px;
        }
        
        .textarea-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        
        .textarea-wrapper {
            position: relative;
            width: 100%;
        }
        
        .text-area {
            width: 100%;
            height: 250px;
            padding: 20px;
            font-size: 1rem;
            line-height: 1.5;
            border: 2px solid var(--textarea-border);
            border-radius: 8px;
            background-color: var(--textarea-bg);
            color: var(--text-color);
            resize: vertical;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow-y: auto;
        }
        
        .text-area:focus {
            outline: none;
            border-color: var(--textarea-focus);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .char-count {
            position: absolute;
            bottom: 10px;
            right: 15px;
            font-size: 0.85rem;
            color: var(--placeholder-text);
            background-color: var(--textarea-bg);
            padding: 2px 8px;
            border-radius: 10px;
        }
        
        .controls-section {
            background: var(--container-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .controls-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--section-border);
        }
        
        .encryption-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .method-btn {
            padding: 10px 20px;
            border: 2px solid var(--method-btn-border);
            border-radius: 8px;
            background-color: var(--method-btn-bg);
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .method-btn:hover {
            background-color: var(--secondary-hover);
            transform: translateY(-2px);
        }
        
        .method-btn.active {
            background-color: var(--method-btn-active);
            color: white;
            border-color: var(--method-btn-active);
        }
        
        .key-input-container {
            margin-bottom: 25px;
            display: none;
        }
        
        .key-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        
        .key-input {
            width: 100%;
            padding: 15px;
            font-size: 1rem;
            border: 2px solid var(--textarea-border);
            border-radius: 8px;
            background-color: var(--textarea-bg);
            color: var(--text-color);
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        .key-input:focus {
            outline: none;
            border-color: var(--textarea-focus);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .caesar-input-container {
            margin-bottom: 25px;
            display: none;
        }
        
        .action-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }
        
        .btn {
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.1rem;
        }
        
        .btn-encrypt {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-encrypt:hover {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-decrypt {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-decrypt:hover {
            background-color: var(--success-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-clear {
            background-color: var(--secondary-bg);
            color: var(--secondary-text);
        }
        
        .btn-clear:hover {
            background-color: var(--secondary-hover);
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .info-section {
            background: var(--container-bg);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px var(--shadow-color);
        }
        
        .info-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--section-border);
        }
        
        .info-content {
            line-height: 1.7;
        }
        
        .info-content p {
            margin-bottom: 15px;
        }
        
        .info-list {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .info-list li {
            margin-bottom: 8px;
        }
        
        .status-message {
            background-color: var(--warning-bg);
            color: var(--warning-text);
            padding: 12px 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            border-left: 4px solid var(--warning-border);
        }
        
        .error-message {
            background-color: var(--error-bg);
            color: var(--error-color);
            padding: 12px 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
            border-left: 4px solid var(--error-color);
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            color: var(--placeholder-text);
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        footer a {
            color: var(--placeholder-text);
            text-decoration: none;
            transition: color 0.3s;
            margin: 0 5px;
        }

        footer a:hover {
            color: var(--primary-color);
        }
        
        .copy-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            background-color: var(--secondary-bg);
            color: var(--secondary-text);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        
        .copy-btn:hover {
            background-color: var(--secondary-hover);
        }
        
        .copy-btn.copied {
            background-color: var(--success-color);
            color: white;
        }
        
        @media (min-width: 1200px) {
            .text-area {
                height: 300px;
            }
        }
        
        @media (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
            }
            
            .encryption-methods {
                justify-content: center;
            }
            
            .theme-toggle {
                position: relative;
                justify-content: center;
                margin-top: 20px;
                top: auto;
                right: auto;
            }
        }
        
        /* 仅限电脑端的提示 */
        .mobile-warning {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            z-index: 10000;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            font-size: 1.5rem;
        }
        
        @media (max-width: 1024px) {
            .mobile-warning {
                display: flex;
            }
            
            body {
                overflow: hidden;
            }
        }

        .support-page {
            display: none;
            width: 100%;
            background: var(--glass-bg);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            padding: 2rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }
        
        .support-page h2 {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: var(--primary-color);
        }
        
        .support-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }
        
        @media (min-width: 769px) {
            .support-container {
                flex-direction: row;
                justify-content: center;
                align-items: flex-start;
                gap: 3rem;
            }
            
            .support-item {
                flex: 0 1 auto;
                max-width: 300px;
            }
            
            .support-image-container {
                width: 220px;
                height: 220px;
            }
        }
        
        @media (max-width: 768px) {
            .support-container {
                flex-direction: column;
                gap: 2rem;
            }
            
            .support-item {
                width: 100%;
            }
            
            .support-image-container {
                width: 200px;
                height: 200px;
            }
        }
        
        .support-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .support-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .support-image-container {
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--card-border);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            padding: 1rem;
            transition: all 0.3s ease;
        }
        
        .support-image {
            max-width: 100%;
            max-height: 100%;
            border-radius: 8px;
        }
        
        .support-description {
            font-size: 1rem;
            text-align: center;
            opacity: 0.9;
            line-height: 1.4;
            margin-top: 1rem;
            color: var(--text-color);
        }
        
        .support-message {
            font-size: 1.1rem;
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: var(--text-color);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .support-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
            align-items: center;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <div class="mobile-warning">
        <div>
            <h2>很抱歉，此网站仅限电脑端打开</h2>
            <p>请在电脑浏览器中打开此页面。</p>
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1>JS加密解密工具</h1>
            <p class="subtitle">支持Base64、AES、DES、RC4加密算法的加密解密网站。</p>
            
            <div class="theme-toggle">
                <span class="theme-label">主题</span>
                <button class="theme-btn" id="themeBtn" aria-label="切换主题">
                    <svg class="sun-icon" viewBox="0 0 24 24" width="24" height="24">
                        <circle class="sun-circle" cx="12" cy="12" r="5"/>
                        <line class="sun-rays" x1="12" y1="1" x2="12" y2="4"/>
                        <line class="sun-rays" x1="12" y1="20" x2="12" y2="23"/>
                        <line class="sun-rays" x1="4.22" y1="4.22" x2="6.34" y2="6.34"/>
                        <line class="sun-rays" x1="17.66" y1="17.66" x2="19.78" y2="19.78"/>
                        <line class="sun-rays" x1="1" y1="12" x2="4" y2="12"/>
                        <line class="sun-rays" x1="20" y1="12" x2="23" y2="12"/>
                        <line class="sun-rays" x1="4.22" y1="19.78" x2="6.34" y2="17.66"/>
                        <line class="sun-rays" x1="17.66" y1="6.34" x2="19.78" y2="4.22"/>
                    </svg>
                    
                    <svg class="moon-icon" viewBox="0 0 24 24" width="24" height="24">
                        <path class="moon-body" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        <circle class="moon-crater" cx="15" cy="10" r="1.5"/>
                        <circle class="moon-crater" cx="12" cy="15" r="1"/>
                        <circle class="moon-crater" cx="17" cy="15" r="0.8"/>
                    </svg>
                </button>
            </div>
        </header>
        
        <div class="main-content">
            <section class="text-section">
                <h2 class="section-title">
                    输入文本
                    <div class="section-controls">
                        <button class="copy-btn" id="copyInputBtn">复制</button>
                    </div>
                </h2>
                <div class="textarea-container">
                    <label class="textarea-label" for="inputText">待加密/解密的文本：</label>
                    <div class="textarea-wrapper">
                        <textarea id="inputText" class="text-area" placeholder="请输入需要加密或解密的文本..."></textarea>
                        <div class="char-count" id="inputCharCount">0 字符</div>
                    </div>
                </div>
            </section>
            
            <section class="text-section">
                <h2 class="section-title">
                    输出文本
                    <div class="section-controls">
                        <button class="copy-btn" id="copyOutputBtn">复制</button>
                    </div>
                </h2>
                <div class="textarea-container">
                    <label class="textarea-label" for="outputText">加密/解密结果：</label>
                    <div class="textarea-wrapper">
                        <textarea id="outputText" class="text-area" placeholder="加密或解密后的结果将显示在这里..." readonly></textarea>
                        <div class="char-count" id="outputCharCount">0 字符</div>
                    </div>
                </div>
            </section>
            
            <section class="controls-section">
                <h2 class="controls-title">加密配置</h2>
                
                <div class="encryption-methods">
                    <button class="method-btn active" data-method="base64">Base64</button>
                    <button class="method-btn" data-method="aes">AES</button>
                    <button class="method-btn" data-method="des">DES</button>
                    <button class="method-btn" data-method="rc4">RC4</button>
                    <button class="method-btn" data-method="xor">XOR</button>
                    <button class="method-btn" data-method="caesar">凯撒密码</button>
                </div>
                
                <div class="key-input-container" id="keyContainer">
                    <label class="key-label" for="encryptionKey">加密密钥：</label>
                    <input type="text" id="encryptionKey" class="key-input" placeholder="请输入您的加密密钥">
                </div>
                
                <div class="caesar-input-container" id="caesarContainer">
                    <label class="key-label" for="caesarShift">偏移量：</label>
                    <input type="number" id="caesarShift" class="key-input" min="1" max="25" placeholder="请输入偏移量（限制：1-25）">
                </div>
                
                <div class="action-buttons">
                    <button id="encryptBtn" class="btn btn-encrypt">加密文本</button>
                    <button id="decryptBtn" class="btn btn-decrypt">解密文本</button>
                    <button id="clearBtn" class="btn btn-clear">清除所有</button>
                </div>
                
                <div id="errorMessage" class="error-message"></div>
                <div id="statusMessage" class="status-message"></div>
            </section>
            
            <section class="info-section">
                <h2 class="info-title">工具说明</h2>
                <div class="info-content">
                    <p>这是一个完全在浏览器本地运行的JavaScript加密解密工具网站，所有数据不会上传到服务器，确保您的数据安全。</p>
                    <p>支持的加密算法：</p>
                    <ul class="info-list">
                        <li>Base64 - 一种编码方式，将二进制数据转换为可打印字符。</li>
                        <li>AES - 高级加密标准，对称加密算法（需要密钥）。</li>
                        <li>DES - 数据加密标准，对称加密算法（需要密钥）。</li>
                        <li>RC4 - 流加密算法，对称加密（需要密钥）。</li>
                        <li>XOR - 异或加密，简单对称加密（需要密钥）。</li>
                        <li>凯撒密码 - 替换式加密，每个字母按字母表顺序偏移固定位置。</li>
                    </ul>
                    <p>使用提示：</p>
                    <ul class="info-list">
                        <li>对于AES、DES、RC4和XOR加密，必须使用相同的密钥进行加密和解密。</li>
                        <li>密钥可以是任意字符串，建议使用复杂组合以提高安全性。</li>
                        <li>大文本处理可能需要一些时间，请耐心等待。</li>
                        <li>所有操作都在您的浏览器本地完成，数据不会离开您的计算机。</li>
                        <li>个人能力有限，有些转换方式可能出错，<span style="color: #e74c3c; ">请务必测试后再考虑投入使用</span>。</li>
                    </ul>
                </div>
            </section>
        </div>

        <div class="support-page" id="supportPage">
            <h2>支持页面</h2>
            <div class="support-container">
                <div class="support-item">
                    <div class="support-title">微信支付</div>
                    <div class="support-image-container">
                        <img src="QR/Wechat_QRC.webp" alt="微信支付" class="support-image" id="wechatQrCode">
                    </div>
                </div>
                
                <div class="support-item">
                    <div class="support-title">支付宝</div>
                    <div class="support-image-container">
                        <img src="QR/Alipay_QR.webp" alt="支付宝" class="support-image" id="alipayQrCode">
                    </div>
                </div>
            </div>
            <div class="support-message">
                如果对你有帮助，请支持我。谢谢！
            </div>
            <div class="support-buttons">
                <button class="btn btn-primary" id="backFromSupport">返回</button>
            </div>
        </div>
        
        <footer>
            <p><a href="#" id="supportLink">支持</a> | <a href="https://m-pureruby.github.io/PureRuby" target="_blank">个人博客：Pure Ruby</a></p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeBtn = document.getElementById('themeBtn');
            
            function initTheme() {
                const savedTheme = localStorage.getItem('theme');
                const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
                
                if (savedTheme) {
                    if (savedTheme === 'dark') {
                        document.body.classList.add('dark-mode');
                    } else {
                        document.body.classList.remove('dark-mode');
                    }
                } else {
                    if (prefersDarkScheme.matches) {
                        document.body.classList.add('dark-mode');
                    } else {
                        document.body.classList.remove('dark-mode');
                    }
                }
            }
            
            function toggleTheme() {
                if (document.body.classList.contains('dark-mode')) {
                    document.body.classList.remove('dark-mode');
                    localStorage.setItem('theme', 'light');
                } else {
                    document.body.classList.add('dark-mode');
                    localStorage.setItem('theme', 'dark');
                }
            }
            
            themeBtn.addEventListener('click', toggleTheme);
            
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                if (!localStorage.getItem('theme')) {
                    if (e.matches) {
                        document.body.classList.add('dark-mode');
                    } else {
                        document.body.classList.remove('dark-mode');
                    }
                }
            });
            
            initTheme();

            const inputText = document.getElementById('inputText');
            const outputText = document.getElementById('outputText');
            const inputCharCount = document.getElementById('inputCharCount');
            const outputCharCount = document.getElementById('outputCharCount');
            const encryptBtn = document.getElementById('encryptBtn');
            const decryptBtn = document.getElementById('decryptBtn');
            const clearBtn = document.getElementById('clearBtn');
            const methodBtns = document.querySelectorAll('.method-btn');
            const encryptionKey = document.getElementById('encryptionKey');
            const caesarShift = document.getElementById('caesarShift');
            const keyContainer = document.getElementById('keyContainer');
            const caesarContainer = document.getElementById('caesarContainer');
            const errorMessage = document.getElementById('errorMessage');
            const statusMessage = document.getElementById('statusMessage');
            const copyInputBtn = document.getElementById('copyInputBtn');
            const copyOutputBtn = document.getElementById('copyOutputBtn');
            const supportLink = document.getElementById('supportLink');
            const supportPage = document.getElementById('supportPage');
            const backFromSupportBtn = document.getElementById('backFromSupport');
            const mainContent = document.querySelector('.main-content');
            
            let currentMethod = 'base64';

            function updateCharCount() {
                const inputLength = inputText.value.length;
                const outputLength = outputText.value.length;
                
                inputCharCount.textContent = `${inputLength} 字符`;
                outputCharCount.textContent = `${outputLength} 字符`;

                if (inputLength > 10000) {
                    showStatus(`正在处理大文本（${inputLength} 字符），请稍候...`);
                }
            }

            function showStatus(message) {
                statusMessage.textContent = message;
                statusMessage.style.display = 'block';
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 3000);
            }

            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 5000);
            }

            methodBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    methodBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentMethod = this.getAttribute('data-method');

                    if (currentMethod === 'caesar') {
                        keyContainer.style.display = 'none';
                        caesarContainer.style.display = 'block';
                    } else if (currentMethod === 'base64') {
                        keyContainer.style.display = 'none';
                        caesarContainer.style.display = 'none';
                    } else {
                        keyContainer.style.display = 'block';
                        caesarContainer.style.display = 'none';
                    }
                });
            });
            
            // Base64
            function base64Encode(text) {
                return btoa(unescape(encodeURIComponent(text)));
            }
            
            function base64Decode(text) {
                try {
                    return decodeURIComponent(escape(atob(text)));
                } catch (e) {
                    throw new Error('Base64解码失败：文本格式不正确');
                }
            }
            
            // AES
            function aesEncrypt(text, key) {
                if (!key) throw new Error('AES加密需要密钥');
                
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const charCode = text.charCodeAt(i) ^ key.charCodeAt(i % key.length);
                    result += String.fromCharCode(charCode);
                }
                return btoa(unescape(encodeURIComponent(result)));
            }
            
            function aesDecrypt(text, key) {
                if (!key) throw new Error('AES解密需要密钥');
                
                try {
                    const decoded = decodeURIComponent(escape(atob(text)));
                    let result = '';
                    for (let i = 0; i < decoded.length; i++) {
                        const charCode = decoded.charCodeAt(i) ^ key.charCodeAt(i % key.length);
                        result += String.fromCharCode(charCode);
                    }
                    return result;
                } catch (e) {
                    throw new Error('AES解密失败：文本格式或密钥不正确');
                }
            }
            
            // DES
            function desEncrypt(text, key) {
                if (!key) throw new Error('DES加密需要密钥');

                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const charCode = (text.charCodeAt(i) + key.charCodeAt(i % key.length)) % 256;
                    result += String.fromCharCode(charCode);
                }
                return btoa(unescape(encodeURIComponent(result)));
            }
            
            function desDecrypt(text, key) {
                if (!key) throw new Error('DES解密需要密钥');
                
                try {
                    const decoded = decodeURIComponent(escape(atob(text)));
                    let result = '';
                    for (let i = 0; i < decoded.length; i++) {
                        let charCode = decoded.charCodeAt(i) - key.charCodeAt(i % key.length);
                        if (charCode < 0) charCode += 256;
                        result += String.fromCharCode(charCode);
                    }
                    return result;
                } catch (e) {
                    throw new Error('DES解密失败：文本格式或密钥不正确');
                }
            }
            
            // RC4
            function rc4Encrypt(text, key) {
                if (!key) throw new Error('RC4加密需要密钥');

                let s = [];
                for (let i = 0; i < 256; i++) {
                    s[i] = i;
                }
                
                let j = 0;
                for (let i = 0; i < 256; i++) {
                    j = (j + s[i] + key.charCodeAt(i % key.length)) % 256;
                    [s[i], s[j]] = [s[j], s[i]];
                }
                
                let i = 0;
                j = 0;
                let result = '';
                
                for (let k = 0; k < text.length; k++) {
                    i = (i + 1) % 256;
                    j = (j + s[i]) % 256;
                    [s[i], s[j]] = [s[j], s[i]];
                    const t = (s[i] + s[j]) % 256;
                    const charCode = text.charCodeAt(k) ^ s[t];
                    result += String.fromCharCode(charCode);
                }
                
                return btoa(unescape(encodeURIComponent(result)));
            }
            
            function rc4Decrypt(text, key) {
                return rc4Encrypt(text, key);
            }
            
            // XOR
            function xorEncrypt(text, key) {
                if (!key) throw new Error('XOR加密需要密钥');
                
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const charCode = text.charCodeAt(i) ^ key.charCodeAt(i % key.length);
                    result += String.fromCharCode(charCode);
                }
                return btoa(unescape(encodeURIComponent(result)));
            }
            
            function xorDecrypt(text, key) {
                return xorEncrypt(text, key);
            }
            
            // 凯撒
            function caesarEncrypt(text, shift) {
                shift = parseInt(shift) % 26;
                let result = '';
                
                for (let i = 0; i < text.length; i++) {
                    let charCode = text.charCodeAt(i);
                    
                    if (charCode >= 65 && charCode <= 90) {
                        charCode = ((charCode - 65 + shift) % 26) + 65;
                    }
                    else if (charCode >= 97 && charCode <= 122) {
                        charCode = ((charCode - 97 + shift) % 26) + 97;
                    }
                    
                    result += String.fromCharCode(charCode);
                }
                
                return result;
            }
            
            function caesarDecrypt(text, shift) {
                shift = parseInt(shift) % 26;
                let result = '';
                
                for (let i = 0; i < text.length; i++) {
                    let charCode = text.charCodeAt(i);

                    if (charCode >= 65 && charCode <= 90) {
                        charCode = ((charCode - 65 - shift + 26) % 26) + 65;
                    }
                    else if (charCode >= 97 && charCode <= 122) {
                        charCode = ((charCode - 97 - shift + 26) % 26) + 97;
                    }
                    
                    result += String.fromCharCode(charCode);
                }
                
                return result;
            }

            encryptBtn.addEventListener('click', function() {
                const text = inputText.value.trim();
                if (!text) {
                    showError('请输入需要加密的文本');
                    return;
                }
                
                try {
                    let result;
                    
                    switch(currentMethod) {
                        case 'base64':
                            result = base64Encode(text);
                            break;
                        case 'aes':
                            result = aesEncrypt(text, encryptionKey.value);
                            break;
                        case 'des':
                            result = desEncrypt(text, encryptionKey.value);
                            break;
                        case 'rc4':
                            result = rc4Encrypt(text, encryptionKey.value);
                            break;
                        case 'xor':
                            result = xorEncrypt(text, encryptionKey.value);
                            break;
                        case 'caesar':
                            result = caesarEncrypt(text, caesarShift.value);
                            break;
                        default:
                            result = base64Encode(text);
                    }
                    
                    outputText.value = result;
                    updateCharCount();
                    showStatus('文本加密成功！');
                    
                } catch (error) {
                    showError(error.message);
                }
            });

            decryptBtn.addEventListener('click', function() {
                const text = inputText.value.trim();
                if (!text) {
                    showError('请输入需要解密的文本');
                    return;
                }
                
                try {
                    let result;
                    
                    switch(currentMethod) {
                        case 'base64':
                            result = base64Decode(text);
                            break;
                        case 'aes':
                            result = aesDecrypt(text, encryptionKey.value);
                            break;
                        case 'des':
                            result = desDecrypt(text, encryptionKey.value);
                            break;
                        case 'rc4':
                            result = rc4Decrypt(text, encryptionKey.value);
                            break;
                        case 'xor':
                            result = xorDecrypt(text, encryptionKey.value);
                            break;
                        case 'caesar':
                            result = caesarDecrypt(text, caesarShift.value);
                            break;
                        default:
                            result = base64Decode(text);
                    }
                    
                    outputText.value = result;
                    updateCharCount();
                    showStatus('文本解密成功！');
                    
                } catch (error) {
                    showError(error.message);
                }
            });

            clearBtn.addEventListener('click', function() {
                inputText.value = '';
                outputText.value = '';
                encryptionKey.value = '';
                caesarShift.value = '3';
                updateCharCount();
                showStatus('已清除所有内容');
            });

            copyInputBtn.addEventListener('click', function() {
                if (!inputText.value) {
                    showError('没有文本可复制');
                    return;
                }
                
                inputText.select();
                document.execCommand('copy');
                
                this.textContent = '已复制';
                this.classList.add('copied');
                
                setTimeout(() => {
                    this.textContent = '复制';
                    this.classList.remove('copied');
                }, 2000);
                
                showStatus('输入文本已复制到剪贴板');
            });

            copyOutputBtn.addEventListener('click', function() {
                if (!outputText.value) {
                    showError('没有文本可复制');
                    return;
                }
                
                outputText.select();
                document.execCommand('copy');
                
                this.textContent = '已复制';
                this.classList.add('copied');
                
                setTimeout(() => {
                    this.textContent = '复制';
                    this.classList.remove('copied');
                }, 2000);
                
                showStatus('输出文本已复制到剪贴板');
            });

            supportLink.addEventListener('click', function(e) {
                e.preventDefault();
                showSupportPage();
            });
            
            backFromSupportBtn.addEventListener('click', function() {
                hideSupportPage();
            });
            
            function showSupportPage() {
                mainContent.style.display = 'none';
                supportPage.style.display = 'block';
            }
            
            function hideSupportPage() {
                mainContent.style.display = 'flex';
                supportPage.style.display = 'none';
            }

            inputText.addEventListener('input', updateCharCount);
            outputText.addEventListener('input', updateCharCount);

            updateCharCount();

            const exampleText = `以下为示例文本：
            
欢迎使用JS加密解密工具！这是一个在线加、解密工具，支持加密算法如下：

1. Base64编码。
2. AES加密。
3. DES加密。
4. RC4加密。
5. XOR加密。
6. 凯撒密码。

所有操作都在浏览器本地完成，不会上传至服务器。`;

            inputText.value = exampleText;
            updateCharCount();
        });
    </script>
</body>
</html>